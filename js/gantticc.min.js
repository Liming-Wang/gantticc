function Project(e,t){if(e===-1){$.extend(this,t)}else if(typeof e==="undefined"){this.pid="";this.title="My Awesome Project";this.start=(new Date).toISOString();this.end=(new Date((new Date).getTime()+1e3*3600*24*49)).toISOString();this.tasks=[];this.addDummyTask()}else{this.pid=e;if(localStorage["project"+this.getPid()]!==null){$.extend(this,JSON.parse(localStorage["project"+this.getPid()]))}else{throw new UserException("invalid project id")}this.loadTasks()}}var gchart;var gantticc=gantticc||{};Project.prototype={getPid:function(){if(this.pid=="0")return"";return this.pid},save:function(){var e={title:this.title,start:this.start,end:this.end};if(gantticc.firebaseId){var t=new Firebase(gantticc.firebaseUrl+gantticc.firebaseId+"/"+this.pid);e.pid=this.pid;t.update(e)}else{localStorage["project"+this.getPid()]=JSON.stringify(e)}},"delete":function(){if(gantticc.firebaseId){var e=new Firebase(gantticc.firebaseUrl+gantticc.firebaseId+"/"+this.pid);e.remove()}else{localStorage.removeItem("project"+this.getPid());localStorage.removeItem("tasks"+this.getPid())}},load:function(){if(localStorage["project"+this.getPid()]!==null){$.extend(this,JSON.parse(localStorage["project"+this.getPid()]))}else{throw new UserException("invalid project id")}},loadTasks:function(){this.tasks=JSON.parse(localStorage["tasks"+this.getPid()])},saveTasks:function(){if(gantticc.firebaseId){var e=new Firebase(gantticc.firebaseUrl+gantticc.firebaseId+"/"+this.pid);e.update({tasks:this.tasks})}else{localStorage["tasks"+this.getPid()]=JSON.stringify(this.tasks)}},getTask:function(e){for(var t=0;t<this.tasks.length;t++){var n=this.tasks[t];if(n.tid==e)return n}return null},deleteTask:function(e){for(var t=0;t<this.tasks.length;t++){var n=this.tasks[t];if(n.tid==e)break}this.tasks.splice(t,1);this.saveTasks()},addTask:function(e){this.tasks.push(e);this.saveTasks()},addDummyTask:function(){var e=new Date;var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());this.tasks.push({tid:"1",title:"New Task",color:"gray",start:t.toISOString(),end:(new Date(t.getTime()+1e3*3600*24*2)).toISOString(),row:"1",notes:"Random notes"})},getTasksOnDate:function(e){var t=[];var n=e.getTime();var r=(new Date(e)).dst();for(var i=0;i<this.tasks.length;i++){var s=this.tasks[i];var o=(new Date(s.start)).getTime();var u=(new Date(s.end)).getTime();if((new Date(s.start)).dst()){o+=1e3*3600}if((new Date(s.end)).dst()){u+=1e3*3600}if(o<=n&&u>=n){t.push($.extend(true,{},s))}}return t},getTasksInWeek:function(e){var t=[];for(var n=0;n<this.tasks.length;n++){var r=this.tasks[n];var i=new Date(r.start);var s=i.getWeekNumber(i);if(s==e){t.push($.extend(true,{},r))}}return t},getDataForHeatMap:function(e){var t=[];var n=(new Date(this.start)).getTime();var r=(new Date(this.end)).getTime();var i=1e3*3600*24;if(e==="week")i=i*7;for(var s=n;s<=r;s+=i){var o;var u=new Date(s);if(e==="day"){o=this.getTasksOnDate(u)}else{o=this.getTasksInWeek(u.getWeekNumber(u))}t.push({date:s,tasks:o})}return t}};gantticc.initUI=function(){$("#gantt").css("min-height",gantticc.getHeight());$("#gmask").css({height:gantticc.getHeight(),top:$("#topbar").height()});$(".datepickr").datepicker();$(".datepickr").on("click",function(e){$(e.target).datepicker("show")});$(".datepickr").on("changeDate",function(e){$(e.target).datepicker("hide")});$("a[rel=tooltip]").tooltip();$("button[rel=tooltip]").tooltip();$("#mtab").on("click",function(){var e=$("#mtab").offset().left;var t=$("#mtab").offset().top;$("#mselects").css({left:e,top:t+2});$("#mselects").show()});$("#project_info_modal").on("show",function(){if(gantticc.project.pid=="0"){$("#prj_inmd_dfprj").text("This project is currently the default project.")}else{$("#prj_inmd_dfprj").html('<button class="btn" onclick="gantticc.setDefaultProject(\''+gantticc.project.pid+"');\">Make this the default project</button>")}$("#prj_ifmd_ptcnt").text(gantticc.project.tasks.length);$("#prj_ifmd_expdata").text(gantticc.exportData("google_cal"))});$(document).bind("mouseup touchstart",function(e){var t=$("#mselects");if(!t.is(e.target)&&t.has(e.target).length===0){t.hide()}});$(document).on("keydown",function(e){if(e.keyCode==27){if($("#task_form").is(":visible"))task_form_cancel();if($("#mselects").is(":visible"))$("#mselects").hide()}else if(e.keyCode==72){if(gantticc.listenKey&&!$("#task_form").is(":visible"))project_heatmap()}else if(e.keyCode==68){if(gantticc.listenKey&&!$("#task_form").is(":visible"))set_scale("day")}else if(e.keyCode==87){if(gantticc.listenKey&&!$("#task_form").is(":visible"))set_scale("week")}else if(e.keyCode==82){if(gantticc.listenKey&&gantticc.resized){gchart.destroy();gantticc.render();gantticc.resized=false}}});$("input[type=text]").bind("focus",function(){gantticc.listenKey=false}).bind("blur",function(){gantticc.listenKey=true});$("textarea").bind("focus",function(){gantticc.listenKey=false}).bind("blur",function(){gantticc.listenKey=true});$(window).on("resize",function(){gantticc.resized=true})};gantticc.init=function(){gantticc.loaded=false;gantticc.authenticated=false;gantticc.resized=false;gantticc.listenKey=true;gantticc.scale="day";gantticc.heatmap={};gantticc.projects=[];gantticc.project=null;gantticc.maxProjCount=5;gantticc.colors=["null","gray","blue","orange"];gantticc.colorValues={gray:["#e5e5e5","#f2f2f2"],blue:["#bee1ef","#d4effc"],orange:["#ff944d","#ffa964"]};gantticc.firebaseUrl="https://gantticc.firebaseio.com/";gantticc.firebasePasscode="";gantticc.passcodeAttempts=0;gantticc.siteUrl="http://gantti.cc/app";gantticc.localstorage=1;if(typeof Storage!=="undefined"){gantticc.localstorage=1}else{alert("Local storage not supported by your browser. If you wish to save your data, please save it online.");gantticc.localstorage=0}gantticc.firebaseId=gantticc.getParamFromURL("fbdb");if(gantticc.firebaseId){gantticc.getFirebasePasscode(gantticc.firebaseId);var e=new Firebase(gantticc.firebaseUrl+gantticc.firebaseId);e.once("value",function(e){if(e.val()==null){gantticc.firebaseId="";gantticc.loadDataFromLocalStorage()}else{var t=e.val();for(var n=0;n<t.length;n++){var r=new Project(-1,t[n]);if(r.pid==="0")gantticc.project=r;gantticc.projects.push(r)}gantticc.updateSharingStatus()}gantticc.render()})}else{gantticc.firebaseId="";gantticc.loadDataFromLocalStorage();gantticc.render()}};gantticc.render=function(){$("#gantt").empty();$("#gmask").show().css("opacity",1);gchart=bonsai.run(document.getElementById("gantt"),{url:"js/gchart.min.js?bustcache="+Math.random(),width:gantticc.getWidth(),height:gantticc.getHeight(),code:function(){stage.on("message:update_task",function(e){if(e.cancel==="true"){ganttClickLock=0;return}var t=null;var n=0;for(n;n<gantticc.tasks.length;n++){t=gantticc.tasks[n];if(t.tid==e.tid)break}if(t==null)return;if(e.delete==="true"){gchart.deleteTaskAnim(t.group_asset);gantticc.tasks.splice(n,1)}else{e.title=e.title;t.title_asset.attr("text",e.title);t.updateIndicatorIcon(e.notes);t.updateTaskColor(e.color)}ganttClickLock=0});stage.on("message:update_project",function(e){if(ganttClickLock>0)return;if(typeof e.start_date!="undefined"){var t=new Date;if(e.scroll_date){t=new Date(e.scroll_date)}gchart.drawHeader(e.start_date,e.end_date);gchart.scrollToDate(t);gchart.updateCurrentUnit()}});stage.on("message:init_tasks",function(e){if(ganttClickLock>0)return;stage.sendMessage("mask_stage",{show:1});setTimeout(function(){gchart.initTasks(e.tasks);stage.sendMessage("mask_stage",{})},300)});stage.on("message:init_heatmap",function(e){if(ganttClickLock>0)return;stage.sendMessage("mask_stage",{show:1});setTimeout(function(){var t=gchart.getScrollDate();if(gchart.unit!==e.unit){gchart.unit=e.unit}gchart.drawHeader(e.start_date,e.end_date);gchart.updateCurrentUnit(1);gchart.initHeatMap({min:e.min,max:e.max,projects:e.data});gchart.scrollToDate(t);stage.sendMessage("scroll_date",{date:t});stage.sendMessage("mask_stage",{})},300)});stage.on("message:scroll_to_date",function(e){var t=new Date(e.date);gchart.scrollToDate(t,1)});stage.on("message:scroll_to_task",function(e){var t=e.task;if(parseInt(t.row)*GANTT_TASK_BLK_HGT>Math.floor(stage.height/2)){var n=parseInt(t.row)*GANTT_TASK_BLK_HGT-Math.floor(stage.height/2);n=Math.ceil(n/GANTT_TASK_BLK_HGT)*GANTT_TASK_BLK_HGT;gchart.scrollY(n)}else{gchart.scrollY(gchart.y)}});stage.on("message:set_swatch",function(e){gchart.highlightTaskByColor(e.color,e.status)});stage.on("message:set_scale",function(e){if(ganttClickLock>0)return;stage.sendMessage("mask_stage",{show:1});setTimeout(function(){var t=new Date;if(gchart.unit===e.unit){gchart.scrollToDate(t)}else{t=gchart.getScrollDate();gchart.unit=e.unit;gchart.drawHeader(e.start_date,e.end_date);gchart.updateCurrentUnit(1);gchart.scrollToDate(t,1)}stage.sendMessage("scroll_date",{date:t});stage.sendMessage("mask_stage",{})},300)});stage.sendMessage("ready",{})}});gchart.on("load",function(e){gchart.on("message:ready",function(e){if(gantticc.authenticated===false){if(gantticc.youShallNotPass()===false){gchart.destroy();return}}var t=(new Date($("#project_startdate").val())).toISOString();var n=(new Date($("#project_enddate").val())).toISOString();var r=new Date;var i=$("#mtab").attr("value")?new Date($("#mtab").attr("value")):r;var s=gantticc.project.getTasksOnDate(new Date);gchart.sendMessage("update_project",{start_date:t,end_date:n,scroll_date:i});gchart.sendMessage("init_tasks",{tasks:gantticc.project.tasks});if(s.length>0){gchart.sendMessage("scroll_to_task",{task:s[0]})}if(!gantticc.loaded){gantticc.showIntro()}gantticc.loaded=true});gchart.on("message:edit_task",function(e){var t=gantticc.project.getTask(e.tid);if(t==null)return;$("#title_tid").val(t.tid);if(t.title==="New Task"){$("#title_txtfield").val("");$("#title_txtfield").attr("placeholder","New Task")}else{$("#title_txtfield").val(t.title);$("#title_txtfield").attr("placeholder","")}if(!t.color)t.color="gray";$("#task_color").val(t.color);for(var n=0;n<gantticc.colors.length;n++){var r=gantticc.colors[n];$("#task_color_"+r).removeClass("swatch_sel")}$("#task_color_"+t.color).addClass("swatch_sel");$("#notes_txtfield").val(t.notes);var i=e.y+$("#topbar").height();if(!$("#settings").is(":hidden"))i+=$("#settings").height();$("#task_form").css({top:i,left:e.x});$("#task_form").show()});gchart.on("message:update_task",function(e){var t=gantticc.project.getTask(e.tid);if(t==null)return;if(e.start)t.start=e.start;if(e.end)t.end=e.end;if(e.row)t.row=e.row;gantticc.project.saveTasks()});gchart.on("message:new_task",function(e){gantticc.project.addTask(e.task)});gchart.on("message:scroll_date",function(e){var t=new Date(e.date);gantticc.updateCurrentMonthBtn(t)});gchart.on("message:update_heatmap",function(e){project_heatmap(e.unit)});gchart.on("message:update_project",function(e){var t=new Date($("#mtab").attr("value"));project_load(e.pid.toString());var n=new Date(gantticc.project.start);var r=new Date(gantticc.project.end);if(t>r)return;if(t<n){t=n}gchart_scroll(t)});gchart.on("message:mask_stage",function(e){if(e.show){$("#gmask").show().animate({opacity:1},300)}else{$("#gmask").animate({opacity:0},300,function(){$("#gmask").hide()})}})});gantticc.applyCurrentProject()};gantticc.getColorValue=function(e){if(!e)e="gray";return gantticc.colorValues[e][0]};gantticc.loadDataFromLocalStorage=function(){if(gantticc.localstorage==1){gantticc.loadAllProjects();if(gantticc.projects.length>0){var e=gantticc.getParamFromURL("project");if(!e)e="0";for(var t=0;t<gantticc.projects.length;t++){var n=gantticc.projects[t];if(e===n.pid){gantticc.project=n}}}else{var n=new Project;gantticc.project=n;gantticc.projects.push(gantticc.project)}}else{gantticc.project=new Project}};gantticc.youShallNotPass=function(e){if(gantticc.passcodeAttempts===-1)return;if(e){var t=$("#passcode").val();if(t!=gantticc.firebasePasscode){$("#passcode").css("border-color","#b94a48");gantticc.passcodeAttempts++;if(gantticc.passcodeAttempts>3)gantticc.passcodeAttempts=-1}else{gantticc.authenticated=true;$("#project_passcode_modal").modal("hide");gantticc.render();gantticc.listenKey=true;if($("#passcodermbr").prop("checked")){gantticc.setCookie(gantticc.firebaseId,gantticc.firebasePasscode)}}}else{if(!gantticc.firebasePasscode){gantticc.authenticated=true;return true}var n=gantticc.getCookie(gantticc.firebaseId);if(n==gantticc.firebasePasscode){gantticc.authenticated=true}else{gantticc.listenKey=false;$("#project_passcode_modal").modal("show");$("#passcode").focus()}return gantticc.authenticated}};gantticc.applyCurrentProject=function(){$("#project_title_txtfield").val(gantticc.project.title);$("#project_startdate").datepicker("setValue",new Date(gantticc.project.start));$("#project_enddate").datepicker("setValue",new Date(gantticc.project.end));project_update(false);gantticc.resetSwatch();gantticc.resetHeatmap()};gantticc.loadAllProjects=function(){if(gantticc.localstorage==0)return;for(var e=0;e<gantticc.maxProjCount;e++){try{var t=new Project(e.toString());gantticc.projects.push(t)}catch(n){break}}};gantticc.updateProjectList=function(){var e=[];e.push('<li><a href="#" onclick="project_new();">Create New Project</a></li>');e.push('<li class="divider"></li>');for(var t=0;t<gantticc.projects.length;t++){var n=gantticc.projects[t];var r='<li><a href="#" onclick="project_load(\''+n.pid+"');\">";if(n.pid===gantticc.project.pid){r+="<b>"+n.title+"</b>"}else{r+=n.title}r+="<span><span></a></li>";e.push(r)}$("#project_list").html(e.join(""))};gantticc.setCurrentProject=function(e){for(var t=0;t<gantticc.projects.length;t++){var n=gantticc.projects[t];if(n.pid===e){gantticc.project=n}}if(!gantticc.firebaseId){try{gantticc.project.load();gantticc.project.loadTasks()}catch(r){gantticc.init()}}gantticc.applyCurrentProject()};gantticc.deleteCurrentProject=function(){gantticc.project.delete();for(var e=0;e<gantticc.projects.length;e++){var t=gantticc.projects[e];if(t.pid==gantticc.project.pid)break}gantticc.projects.splice(e,1);if(gantticc.projects.length==0){var t=new Project;gantticc.project=t;gantticc.projects.push(gantticc.project)}else{gantticc.project=gantticc.projects[0]}};gantticc.getLiteralMonth=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e]};gantticc.updateCurrentMonthBtn=function(e){$("#mtab").text(gantticc.getLiteralMonth(e.getMonth()));$("#mtab").attr("value",e.toISOString())};gantticc.updateJumpMonthMenu=function(e,t){if(!e)e=gantticc.project.start;if(!t)t=gantticc.project.end;var n=[];var r=new Date(e);var i=new Date(t);for(var s=r.getFullYear();s<=i.getFullYear();s++){if(s!=r.getFullYear()){n.push('<li class="disabled">'+"<a>"+s+"</a></li>")}var o=s==i.getFullYear()?i.getMonth():11;var u=s==r.getFullYear()?r.getMonth():0;for(var a=u;a<=o;a++){var f=n.length>0?1:r.getDate();var l='<li><a href="#" onclick="gchart_scroll(new Date('+s+","+a+","+f+'))">';l+=gantticc.getLiteralMonth(a)+"</a></li>";n.push(l)}}$("#mselects").html(n.join(""))};gantticc.addNewProject=function(){if(gantticc.projects.length>=gantticc.maxProjCount)return null;gantticc.project.save();gantticc.project.saveTasks();gantticc.project=new Project;gantticc.project.title="New Project";gantticc.project.pid=gantticc.projects.length.toString();gantticc.projects.push(gantticc.project);$("#project_title_txtfield").focus();return true};gantticc.exportData=function(e){if(e==="google_cal"){var t=[];t.push("Subject,Start Date,End Date,Description");for(var n=0;n<gantticc.project.tasks.length;n++){var r=gantticc.project.tasks[n];var i=r.start.split("T")[0];i.split("-").join("/");var s=r.end.split("T")[0];s.split("-").join("/");t.push(r.title+","+i+","+s+","+r.notes)}return t.join("\n")}else if(e==="print"){var o=[];var u=(new Date(gantticc.project.start)).getTime();var a=(new Date(gantticc.project.end)).getTime();var f=1e3*3600*24;for(var r=u;r<=a;r+=f){var l=new Date(r);var c=gantticc.project.getTasksOnDate(l);if(c.length>0){o.push("<h4>"+l.toDateString()+"</h4>");var h="<ul>";for(var n=0;n<c.length;n++){h+='<li><span class="tchbx"></span><span class="ttl">'+c[n].title+"</span></li>"}h+="</ul>";o.push(h)}}return o.join("")}return""};gantticc.getParamFromURL=function(e){var t=window.location.search.substr(1);var n=t.split("&");var r={};for(var i=0;i<n.length;i++){var s=n[i].split("=");if(s[0]===e)return s[1]}return""};gantticc.setDefaultProject=function(e){var t=null,n=null;for(var r=0;r<gantticc.projects.length;r++){var i=gantticc.projects[r];if(i.pid===e)t=i;if(i.pid==="0")n=i}if(!t||!n)return;n.pid=e;n.save();n.saveTasks();t.pid="0";t.save();t.saveTasks();$("#prj_inmd_dfprj").text("This project has been set as the default project.")};gantticc.resetSwatch=function(){for(var e=1;e<gantticc.colors.length;e++){var t=gantticc.colors[e];var n=$(".swatch_"+t).next().first();n.addClass("swatch_checked")}};gantticc.resetHeatmap=function(){$("#heatmap_status").html("Heat Map").attr("value","")};gantticc.getAllTasksOnDate=function(e){var t=[];for(var n=0;n<gantticc.projects.length;n++){$.merge(t,gantticc.projects[n].getTasksOnDate(e))}return t};gantticc.getAllTasksInWeek=function(e){var t=[];for(var n=0;n<gantticc.projects.length;n++){$.merge(t,gantticc.projects[n].getTasksInWeek(e))}return t};gantticc.getWidth=function(){return $("#controls").width()};gantticc.getHeight=function(){var e=$(document).height()-$("#topbar").height();if($("#botbar").is(":visible"))e-=$("#botbar").height();return e};gantticc.openInNewWind=function(){var e=location.protocol+"//"+location.host+location.pathname+"?project="+gantticc.project.pid;window.open(e)};gantticc.shareToFirebase=function(){var e=$("#project_share_id").val();var t=new Firebase(gantticc.firebaseUrl+e);t.once("value",function(n){if(n.val()==null){t.set(gantticc.projects,function(){var t=gantticc.siteUrl+"?fbdb="+e;$("#prj_share_link").text(t).show()});if($("#project_share_passcode").val()){gantticc.setFirebasePasscode(e,$("#project_share_passcode").val());$("#project_share_passcode").parent().parent().addClass("success")}$("#project_share_id").parent().parent().removeClass("error").addClass("success")}else{$("#project_share_id").parent().parent().addClass("error");$("#prj_sharefrm_output").html("That sharing ID has been used, pick another one.")}})};gantticc.removeFromFirebase=function(){if(gantticc.firebaseId){var e=new Firebase(gantticc.firebaseUrl+gantticc.firebaseId);e.remove();if(gantticc.firebasePasscode){var e=new Firebase(gantticc.firebaseUrl+"projects/"+gantticc.firebaseId);e.remove()}gantticc.firebaseId="";gantticc.save();$("#rmfmfbdb").parent().append("<p>This project has been removed from server.</p>")}};gantticc.setFirebasePasscode=function(e,t){var n=new Firebase(gantticc.firebaseUrl+"projects");var r={};r[e]=t;n.update(r)};gantticc.getFirebasePasscode=function(e){var t=new Firebase(gantticc.firebaseUrl+"projects");var n=t.startAt(null,e);n.once("value",function(t){if(t.val()==null){gantticc.firebasePasscode=""}else{var n=t.val();gantticc.firebasePasscode=n[e]}})};gantticc.updateFirebasePasscode=function(){if(!gantticc.authenticated){return}gantticc.setFirebasePasscode(gantticc.firebaseId,$("#pspasscd").val());$("#pspasscd").parent().append('<span id="pspasscdok" class="help-inline">Passcode updated.</span>');setTimeout(function(){$("#pspasscdok").remove()},2e3)};gantticc.updateSharingStatus=function(){if(gantticc.firebaseId){var e=gantticc.siteUrl+"?fbdb="+gantticc.firebaseId;var t='<p>This gantticc is currently shared at: <code><a href="'+e+'">'+e+"</a></code></p>";t+='<form class="form-inline">';t+='<label for="pspasscd">Passcode: </label>\n';t+='<input type="password" class="input input-small" name="pspasscd" id="pspasscd" value="';if(gantticc.firebasePasscode){for(var n=0;n<gantticc.firebasePasscode.length;n++)t+="*"}t+='" size="4" />\n';t+='<button class="btn" onclick="gantticc.updateFirebasePasscode();return false;">Update</button>';t+="</form>";t+="<p>To disable sharing, you need to delete data completely from server. But don't worry, you still have a local copy of your data.</p>";t+='<button id="rmfmfbdb" class="btn btn-danger" onclick="gantticc.removeFromFirebase();">Delete data from server</button>';$("#project_share_modal_body").html(t)}};gantticc.save=function(){if(gantticc.localstorage==0)return;for(var e=0;e<gantticc.projects.length;e++){gantticc.projects[e].save();gantticc.projects[e].saveTasks()}};gantticc.showIntro=function(){if(gantticc.getCookie("firsttime").length<1){$("#gantticc_help_modal").modal("show")}gantticc.setCookie("firsttime","no",10)};gantticc.setCookie=function(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(r==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i};gantticc.getCookie=function(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("="));r=i[t].substr(i[t].indexOf("=")+1);n=n.replace(/^\s+|\s+$/g,"");if(n==e)return unescape(r)}return""};gantticc.print=function(){$("#printwrap").html(gantticc.exportData("print"));window.print()};Date.prototype.getWeekNumber=function(e){e=new Date(e);e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);var n=Math.ceil(((e-t)/864e5+1)/7);return n};Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1);var t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()}