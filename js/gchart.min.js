function DateBlock(e,t,n,r,i){this.x=t;this.y=n;this.date=r;this.text=i;this.show(e)}function TaskBlock(e,t,n){this.x=t;if(n.count){this.count=n.count;this.y=n.y;this.dayspan=1;this.weekspan=1;this.width=GANTT_DAY_BLK_LEN*this.dayspan;this.startDate=new Date(n.date)}else{this.y=GANTT_TASK_BLK_HGT*parseInt(n.row);this.tid=n.tid;this.dayspan=this.calculateDaySpan(n.end,n.start);this.weekspan=null;this.width=GANTT_DAY_BLK_LEN*this.dayspan;this.startDate=new Date(n.start);this.endDate=new Date(n.end);this.title=n.title;if(n.notes.length>0){this.notes="show"}}this.color=n.color?n.color:"gray";this.show(e)}function Gantt(e,t){this.x=e;this.y=t;this.width=30*GANTT_DAY_BLK_LEN;this.height=0;this.unit="day";this.mode="gantt";var n=new Date;this.leftbar=(new Group).addTo(stage);this.leftbar_titles=(new Group).attr({x:1,y:0}).addTo(stage);var r=OFFSET_TXT_VERT_ALIGN?5+13:5;(new Rect(0,0,GANTT_UNIT_INDT_LEN-2,stage.height)).attr({strokeColor:"#fff",strokeWidth:2}).fill("#fff").addTo(this.leftbar);this.unitIndicator=(new Text(n.getLiteralMonth(n.getMonth()))).addTo(this.leftbar);this.unitIndicator.attr({x:3,y:r,textFillColor:color.parse(gantticc.header_color[0]),fontFamily:"Helvetica, sans-serif",fontSize:"20px"});this.bg=(new Group).attr({x:e,y:t}).addTo(ganttContext);this.body=(new Group).attr({x:e,y:t}).addTo(ganttContext);this.header=(new Group).attr({x:e,y:t}).addTo(ganttContext);this.show(ganttContext)}function HeatMapTitle(e,t,n){this.x=n.x;this.y=n.y;this.text=t;this.width=n.width;this.height=n.height;this.show(e)}var GANTT_DAY_BLK_LEN=35;var GANTT_TASK_BLK_HGT=30;var GANTT_UNIT_INDT_LEN=43;var TASK_POPUP_LEN=250;var IOS_USER=false;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){IOS_USER=true}var OFFSET_TXT_VERT_ALIGN=false;if(navigator.userAgent.indexOf("Firefox")!=-1||navigator.userAgent.indexOf("Opera")!=-1){OFFSET_TXT_VERT_ALIGN=true}else if(navigator.appName=="Microsoft Internet Explorer"){OFFSET_TXT_VERT_ALIGN=true}var ganttContext=(new Group).addTo(stage);var gantticc={dates:[],tasks:[],today_color:"#f0f5f7",header_color:["#19629b","#3f9ccb"],gray:["#e5e5e5","#f2f2f2"],blue:["#bee1ef","#d4effc"],orange:["#ff944d","#ffa964"]};var ganttClickLock=0;var ganttClickCount=0;var ganttTouchCount=0;var ganttClickX=ganttClickY=0;DateBlock.prototype={show:function(e){var t=this;t.textAsset=(new Text(t.text)).addTo(e);var n=parseInt(t.text)<10?13:7;var r=OFFSET_TXT_VERT_ALIGN?t.y+13:t.y;t.textAsset.attr({x:t.x+n,y:r,textFillColor:color.parse(gantticc.header_color[0]),fontFamily:"Helvetica, sans-serif",fontSize:"20px"})},setColor:function(e){this.textAsset.attr({textFillColor:color.parse(e)})},sameDate:function(e){if(e.getFullYear()!=this.date.getFullYear())return false;if(e.getMonth()!=this.date.getMonth())return false;if(e.getDate()!=this.date.getDate())return false;return true},sameWeek:function(e){if(e.getWeekNumber(e)!=this.date.getWeekNumber(this.date))return false;return true}};TaskBlock.prototype={show:function(e){var t=this;var n=(new Group).attr({x:t.x,y:t.y,cursor:"pointer"}).addTo(e);t.group_asset=n;var r=this.weekspan===null?this.dayspan:Math.ceil(this.weekspan);var i=gantticc[t.color][0];var s;if(t.count){var o=t.y==60?"rgba(240,88,13":"rgba(30,130,189";var u=o+","+gchart.getHeatMapColorOpacity(parseInt(t.count))+")";n.attr("cursor","default");s=(new Rect(0,0,GANTT_DAY_BLK_LEN*r,GANTT_TASK_BLK_HGT)).fill(color.parse(u)).addTo(n);t.bg_asset=s;n.on("mouseover",function(e){stage.emit("heatmapblkmsover",t,e)}).on("mouseout",function(e){stage.emit("heatmapblkmsout",t,e)});return}else{s=(new Rect(0,0,GANTT_DAY_BLK_LEN*r,GANTT_TASK_BLK_HGT)).attr({filters:filter.blur(0)}).fill(color.parse(i)).addTo(n)}t.bg_asset=s;n.on("mouseover",function(e){var n=gantticc[t.color][1];t.bg_asset.animate("0.2s",{fillColor:color.parse(n)});t.edgeDrag_asset.attr({opacity:1})}).on("mouseout",function(e){var n=gantticc[t.color][0];t.bg_asset.animate("0.2s",{fillColor:color.parse(n)});t.edgeDrag_asset.attr({opacity:0})}).on("pointerdown",function(e){stage.emit("taskpointerdown",t,e)}).on("pointerup",function(e){ganttClickLock=0});var a=8;var f=IOS_USER?8:10;if(OFFSET_TXT_VERT_ALIGN)f+=11;if(t.notes){t.addIndicatorIcon(n);a+=2}var l=(new Text(t.title)).addTo(n);t.title_asset=l;l.attr({x:a,y:f,textFillColor:color.parse("#333"),fontFamily:"Helvetica, sans-serif",fontSize:"16px"});t.edgeDrag_asset=(new Group).attr({x:t.width-3,y:0,opacity:0}).addTo(n);var c=(new Rect(0,0,3,GANTT_TASK_BLK_HGT)).attr({filters:filter.blur(0)}).fill(color.parse("rgba(0,0,0,0.5)")).addTo(t.edgeDrag_asset)},showEditForm:function(e,t,n,r){var i=e.x- -1*t.x;if(-1*t.x+GANTT_UNIT_INDT_LEN>e.x||i>stage.width-TASK_POPUP_LEN){t.scrollToDate(e.startDate,1)}var s=Math.ceil(e.y/GANTT_TASK_BLK_HGT);var o=t.y+(s+1)*GANTT_TASK_BLK_HGT;stage.sendMessage("edit_task",{tid:e.tid,x:e.x- -1*t.x,y:o});ganttClickLock=1},updateTaskColor:function(e){this.color=e;var t=gantticc[e][0];this.bg_asset.fill(color.parse(t))},addIndicatorIcon:function(e){this.indicator_asset=(new Rect(0,0,3,GANTT_TASK_BLK_HGT)).attr({filters:filter.blur(0)}).fill(color.parse("rgba(0,0,0,0.5)")).addTo(e)},updateIndicatorIcon:function(e){var t=this;if(e.length>0){if(typeof t.indicator_asset=="undefined"){t.addIndicatorIcon(t.group_asset)}else{t.indicator_asset.attr({visible:true})}t.title_asset.attr({x:10});t.notes="show"}else{if(typeof t.indicator_asset!="undefined"){t.indicator_asset.attr({visible:false})}t.title_asset.attr({x:8});t.notes=""}},calculateDaySpan:function(e,t){var n=(new Date(e)).getTime();var r=(new Date(t)).getTime();var i=Math.abs(r-n)/1e3;if((new Date(e)).dst()){n+=3600*1e3}if((new Date(t)).dst()){r+=3600*1e3}var s=Math.ceil(i/(3600*24))+1;return s},calculateWeekSpan:function(e,t){var n=(new Date(e)).getTime();var r=(new Date(t)).getTime();var i=Math.abs(r-n)/1e3/(3600*24);return Math.floor(i/7)+1},updateSpan:function(e){if(this.count)return;if(this.weekspan===null){if(e==="day")return;this.weekspan=this.dayspan/7;this.dayspan=null;this.width=Math.ceil(this.weekspan)*GANTT_DAY_BLK_LEN}else{if(e==="week")return;this.dayspan=Math.ceil(this.weekspan*7);this.weekspan=null;this.width=this.dayspan*GANTT_DAY_BLK_LEN}this.bg_asset.attr({width:this.width});if(!this.count)this.edgeDrag_asset.attr({x:this.width-2})},calculateDateFromX:function(e){var t=Math.ceil(e/GANTT_DAY_BLK_LEN);var n=gantticc.dates[t];if(typeof n=="undefined")return null;return new Date(n.date)},calculateXFromDate:function(e){var t=-1;for(var n=0;n<gantticc.dates.length;n++){var r=gantticc.dates[n];if(gchart.unit==="day"){if(r.sameDate(e)){t=n*GANTT_DAY_BLK_LEN;break}}else{if(r.sameWeek(e)){t=n*GANTT_DAY_BLK_LEN;break}}}return t}};Gantt.prototype={show:function(e){var t=this;var n=null;var r=0;var i=0;var s=y_start=0;var o=y_offset=0;stage.on("pointerdown",function(e){if(ganttClickLock!=0)return;if(e.x<GANTT_UNIT_INDT_LEN)return;if(ganttTouchCount>1)return;ganttClickCount++;r=2;s=e.x;y_start=e.y;ganttClickX=e.x;ganttClickY=e.y;setTimeout(function(){if(ganttClickCount==2){i=0;if(t.mode==="gantt"){gchart.addNewTask(ganttClickX,ganttClickY)}else{var e=Math.floor(ganttClickY/60)-2;if(e>=0)stage.sendMessage("update_project",{pid:e})}}ganttClickCount=0},500)});stage.on("pointermove",function(e){if(ganttTouchCount>1)return;if(r==1&&n!=null){if(i==0)i=1;if(i==1){n.x+=e.x-o-n.x;n.y+=e.y-y_offset-n.y;n.group_asset.attr({x:n.x,y:n.y});var u=t.positionSnapY(e.y-15);if(u>0&&u!=n.row){var a=u>n.row?-1:1;t.shiftTasksByRow(u,a,n.tid);n.row=u}}else if(i==2){if(t.unit==="day"){n.width=GANTT_DAY_BLK_LEN*n.dayspan+e.x-o-n.x}else{n.width=GANTT_DAY_BLK_LEN*n.weekspan+e.x-o-n.x}if(n.width<=GANTT_DAY_BLK_LEN)n.width=GANTT_DAY_BLK_LEN;n.bg_asset.attr("width",n.width);n.edgeDrag_asset.attr({x:n.width-2})}}else if(r==2){ganttClickCount=0;if(ganttTouchCount>1)return;var f=s-e.x;var l=y_start-e.y;if(Math.abs(f)>Math.abs(l)){t.scrollX(f)}else{if(t.mode!=="heatmap")t.scrollY(l)}s=e.x;y_start=e.y;i=1}});stage.on("pointerup",function(e){if(r==1&&n!=null){if(i==0){n.showEditForm(n,t,e.x,e.y)}else if(i==1){n.x=t.positionSnapX(n.x,0);n.y=n.row*GANTT_TASK_BLK_HGT;if(Math.abs(e.x-s)>3&&Math.abs(e.y-y_start)>2){n.startDate=n.calculateDateFromX(n.x);n.group_asset.animate("0.3s",{x:n.x,y:n.y},{easing:"sineOut"});var o=n.startDate.getTime();if(n.weekspan===null){n.endDate=new Date(o+1e3*3600*24*(n.dayspan-1))}else{n.endDate=new Date(o+1e3*3600*24*7*n.weekspan)}stage.sendMessage("update_task",{tid:n.tid,start:n.startDate.toISOString(),end:n.endDate.toISOString(),row:n.row.toString()})}else{n.showEditForm(n,t,e.x,e.y);n.group_asset.attr({x:n.x,y:n.y})}}else if(i==2){var u=n.weekspan===null?n.dayspan:Math.ceil(n.weekspan);n.width=t.positionSnapX(n.width,0);n.bg_asset.attr("width",n.width);n.endDate=n.calculateDateFromX(n.x+n.width-GANTT_DAY_BLK_LEN);if(n.weekspan===null){n.dayspan=n.calculateDaySpan(n.endDate,n.startDate)}else{n.endDate=n.calculateDateFromX(n.x+n.width);var a=(new Date(n.endDate)).getTime();a-=1e3*3600*24;if((new Date(n.endDate)).dst()){a+=1e3*3600}n.endDate=new Date(a);n.weekspan=n.calculateWeekSpan(n.startDate,n.endDate)}stage.sendMessage("update_task",{tid:n.tid,end:n.endDate.toISOString()});n.edgeDrag_asset.attr({x:n.width-2,opacity:0})}i=0;n=null}else if(r==2){if(i==1){t.scrollSnapX();t.scrollCheck();stage.sendMessage("scroll_date",{date:TaskBlock.prototype.calculateDateFromX(-1*t.x+GANTT_UNIT_INDT_LEN)})}}r=0});stage.on("taskpointerdown",function(e,s){ganttClickLock=1;r=1;o=s.x-e.x;y_offset=s.y-e.y;n=e;n.row=Math.ceil(n.y/GANTT_TASK_BLK_HGT);var u=n.weekspan===null?n.dayspan:Math.ceil(n.weekspan);var a=Math.abs(s.x-n.x-t.x-u*GANTT_DAY_BLK_LEN);if(a<7){i=2}else{i=0}});stage.on("multi:pointerdown",function(e){if(ganttClickLock!=0)return;ganttTouchCount++;ganttClickX=e.x;ganttClickY=e.y});stage.on("multi:pointerup",function(e){var n=ganttTouchCount;ganttTouchCount--;if(ganttTouchCount<0)ganttTouchCount=0;if(n==2){var r=e.x-ganttClickX;if(r>stage.width/4){var i="on";if(t.mode==="heatmap")i="off";stage.sendMessage("update_heatmap",{unit:t.unit,status:i})}}})},calculateRowFromY:function(e,t){var n=e;if(n%GANTT_TASK_BLK_HGT>GANTT_TASK_BLK_HGT/2){n+=GANTT_TASK_BLK_HGT-n%GANTT_TASK_BLK_HGT}else{n-=n%GANTT_TASK_BLK_HGT}for(var r=0;r<gantticc.tasks.length;r++){var i=gantticc.tasks[r];if(i.y==n&&i.tid!=t)n+=GANTT_TASK_BLK_HGT}return Math.floor(n/GANTT_TASK_BLK_HGT)},positionSnapX:function(e,t){var n=e+ -1*t;if(n%GANTT_DAY_BLK_LEN>GANTT_DAY_BLK_LEN/2){n+=GANTT_DAY_BLK_LEN-n%GANTT_DAY_BLK_LEN}else{n-=n%GANTT_DAY_BLK_LEN}return n},positionSnapY:function(e){var t=e+Math.abs(this.y);if(t%GANTT_TASK_BLK_HGT>GANTT_TASK_BLK_HGT/2){t+=GANTT_TASK_BLK_HGT-t%GANTT_TASK_BLK_HGT}else{t-=t%GANTT_TASK_BLK_HGT}return Math.ceil(t/GANTT_TASK_BLK_HGT)},addNewTask:function(e,t){if(ganttClickLock!=0)return;var n=this;var r=n.positionSnapX(e,n.x);var i=1;if(gantticc.tasks.length>0){var s=gantticc.tasks[gantticc.tasks.length-1];i=parseInt(s.tid)+1}i=i.toString();var o=n.positionSnapY(t);n.shiftTasksByRow(o,1,i,1);new_y=o*GANTT_TASK_BLK_HGT;var u=TaskBlock.prototype.calculateDateFromX(r).toISOString();var a=24*2;if(n.unit==="week")a=24*6;var f=(new Date((new Date(u)).getTime()+1e3*3600*a)).toISOString();var l={tid:i,title:"New Task",color:"gray",row:o.toString(),start:u,end:f,notes:""};stage.sendMessage("new_task",{task:l});var c=new TaskBlock(n.body,r,l);c.updateSpan(n.unit);gantticc.tasks.push(c);var h=new Animation("0.2s",{scaleX:1,scaleY:1},{easing:"expoIn"});c.group_asset.animate("0.15s",{scaleX:1.3,scaleY:1.3},{easing:"expoOut",onEnd:function(){c.group_asset.animate(h)}})},deleteTaskAnim:function(e){var t=new Animation("0.2s",{scaleX:.1,scaleY:.1,opacity:0},{easing:"expoIn"});e.animate("0.15s",{scaleX:1.1,scaleY:1.1},{easing:"expoOut",onEnd:function(){e.animate(t)}});setTimeout(function(){gchart.body.removeChild(e)},350)},drawHeader:function(e,t){this.header.clear();this.bg.clear();gantticc.dates.length=0;var n=new Date(e);var r=new Date(t);var i=0;var s=6;var o=0;if(this.unit==="day"){for(var u=n.getFullYear();u<=r.getFullYear();u++){var a=u==r.getFullYear()?r.getMonth():11;var f=u==n.getFullYear()?n.getMonth():0;for(var l=f;l<=a;l++){var c=l==r.getMonth()?r.getDate():r.getDaysInMonth(u,l);var h=o>0?1:n.getDate();for(var p=h;p<=c;p++){var d=(new Rect(i,0,1,GANTT_TASK_BLK_HGT-1)).addTo(this.header);var v=(new Rect(i,0,1,stage.height)).addTo(this.bg);if(p==1){d.fill(gantticc.header_color[0]);v.fill(gantticc.header_color[0])}else{d.fill("#eee");v.fill("#eee")}var m=new Date(u,l,p);var g=new DateBlock(this.header,i,s,m,p.toString());if(m.getDay()==0||m.getDay()==6)g.setColor(gantticc.header_color[1]);gantticc.dates.push(g);i+=GANTT_DAY_BLK_LEN;o++}}}}else if(this.unit==="week"){var y=null;var b=0;for(var u=n.getFullYear();u<=r.getFullYear();u++){var a=u==r.getFullYear()?r.getMonth():11;var f=u==n.getFullYear()?n.getMonth():0;for(var l=f;l<=a;l++){var c=l==r.getMonth()?r.getDate():r.getDaysInMonth(u,l);var h=b>0?1:n.getDate();for(var p=h;p<c;){var w=7;var E=new Date(u,l,p);if(E.getDaysInMonth(u,l)-p<6){w=-1;y=new Date(u,l,p);b++}else{if(E.getDay()!=1){var S=8-E.getDay();if(S==8)S=1;if(S==7)S=0;w=S}if(y!=null){E=y;y=null}}if(w<0)break;var d=(new Rect(i,0,1,GANTT_TASK_BLK_HGT-1)).addTo(this.header);var v=(new Rect(i,0,1,stage.height)).addTo(this.bg);if(p==1){d.fill(gantticc.header_color[0]);v.fill(gantticc.header_color[0])}else{d.fill("#eee");v.fill("#eee")}var x=E.getWeekNumber(E);var g=new DateBlock(this.header,i,s,E,x.toString());gantticc.dates.push(g);i+=GANTT_DAY_BLK_LEN;o++;b++;if(w==0)break;p+=w}}}}var T=(new Rect(i-1,0,1,stage.height)).addTo(this.bg);var N=(new Rect(i-1,0,1,GANTT_TASK_BLK_HGT-1)).addTo(this.header);T.fill("#eee");N.fill("#eee");var C=new Date;var k=TaskBlock.prototype.calculateXFromDate(C);if(k>=0){var L=(new Rect(k+1,0,GANTT_DAY_BLK_LEN-1,stage.height)).addTo(this.bg);var A=(new Rect(k+1,-1,GANTT_DAY_BLK_LEN-1,GANTT_TASK_BLK_HGT)).addBefore(gantticc.dates[0].textAsset);L.fill(gantticc.today_color);A.fill(gantticc.today_color)}this.width=o*GANTT_DAY_BLK_LEN;for(var O=0;O<gantticc.tasks.length;O++){var M=gantticc.tasks[O];M.updateSpan(this.unit);var _=M.calculateXFromDate(M.startDate);if(_!=M.x){M.x=_;M.group_asset.attr("x",_)}}if(!this.mask){this.mask=(new Rect(0,-1,this.width,GANTT_TASK_BLK_HGT)).fill("white");this.mask.addAfter(this.body)}else{this.mask.attr({width:this.width})}},initTasks:function(e){this.mode="gantt";if(gantticc.tasks.length>0){gantticc.tasks.length=0;this.body.clear()}this.leftbar_titles.clear();if(typeof e=="undefined")return;for(var t=0;t<e.length;t++){var n=e[t];var r=TaskBlock.prototype.calculateXFromDate(new Date(n.start));var i=new TaskBlock(this.body,r,n);gantticc.tasks.push(i);if(this.unit==="week"){i.updateSpan(this.unit)}}if(this.tooltip_group)this.tooltip_group.attr("visible",false)},initHeatMap:function(e){var t=this;t.mode="heatmap";if(gantticc.tasks.length>0){gantticc.tasks.length=0;t.body.clear()}if(typeof e=="undefined")return;t.leftbar_titles.clear();t.heatmap={min:parseInt(e.min),max:parseInt(e.max)};var n=e.projects;for(var r=0;r<n.length;r++){var i=n[r];var s=(r+1)*60+8;if(OFFSET_TXT_VERT_ALIGN)s+=13;var o=new HeatMapTitle(t.leftbar_titles,i.title,{x:0,y:s,width:GANTT_UNIT_INDT_LEN-3,height:GANTT_TASK_BLK_HGT});for(var u=0;u<i.data.length;u++){var a=i.data[u];if(a.tasks.length>t.heatmap.min){a.count=a.tasks.length.toString();a.y=(r+1)*60;var f=TaskBlock.prototype.calculateXFromDate(new Date(a.date));var l=new TaskBlock(t.body,f,a);gantticc.tasks.push(l)}}}t.y=0;t.body.attr("y",t.y);if(!t.tooltip_group){t.tooltip_group=(new Group).addTo(stage).attr("visible",false);t.tooltip=(new Text("0 tasks")).addTo(t.tooltip_group).attr({fontFamily:"Helvetica, sans-serif",fontSize:"16px",textFillColor:gantticc.header_color[0]})}stage.on("heatmapblkmsover",function(e,n){var r=parseInt(e.count)==1?" task":" tasks";t.tooltip.attr("text",e.count+r);t.tooltip_group.attr({x:n.x,y:e.y-15,visible:true})}).on("heatmapblkmsout",function(e,n){t.tooltip_group.attr("visible",false)})},getHeatMapColorOpacity:function(e){if(!this.heatmap.min&&!this.heatmap.max)return;var t=(this.heatmap.max-this.heatmap.min)/10;var n=e/this.heatmap.max*t;return n},scrollX:function(e,t){this.x=this.x-e;if(t==1){ganttContext.animate("0.5s",{x:this.x},{easing:"sineInOut"})}else{ganttContext.attr("x",this.x)}this.updateCurrentUnit()},scrollY:function(e,t){this.y=this.y-e;if(t==1){this.body.animate("0.5s",{y:this.y},{easing:"sineInOut"})}else{this.body.attr("y",this.y)}},scrollCheck:function(){var e=GANTT_UNIT_INDT_LEN;if(this.width-stage.width<0){this.x=GANTT_UNIT_INDT_LEN}else{if(this.x>e){this.x=e}else if(Math.abs(this.x)>this.width-stage.width){this.x=-1*(this.width-stage.width)}}ganttContext.animate("0.5s",{x:this.x},{easing:"sineOut"});this.updateCurrentUnit();if(this.y>0){this.y=0;this.body.animate("0.3s",{y:this.y},{easing:"sineOut"})}},scrollToDate:function(e,t){var n=TaskBlock.prototype.calculateXFromDate(e);if(n>=0){var r=n-Math.abs(this.x-GANTT_UNIT_INDT_LEN);this.scrollX(r,t);this.updateCurrentUnit()}},updateCurrentUnit:function(e){if(typeof e=="undefined"&&this.x>GANTT_UNIT_INDT_LEN)return;var t=TaskBlock.prototype.calculateDateFromX(-1*this.x+GANTT_UNIT_INDT_LEN);if(t==null)return;var n="";if(this.unit==="day"){n=t.getLiteralMonth(t.getMonth())}else{n=t.getFullYear().toString();n="'"+n.substr(2,2)}this.unitIndicator.attr({text:n})},scrollSnapX:function(){var e=this.positionSnapX(-1*this.x,0);if(this.x!=e){var t=e-Math.abs(this.x-8);this.scrollX(t,1)}},getScrollDate:function(){var e=TaskBlock.prototype.calculateDateFromX(-1*this.x+GANTT_UNIT_INDT_LEN);return e},highlightTaskByColor:function(e,t){for(var n=0;n<gantticc.tasks.length;n++){var r=gantticc.tasks[n];if(r.color==e){r.group_asset.attr({visible:t})}}},shiftTasksByRow:function(e,t,n,r){for(var i=0;i<gantticc.tasks.length;i++){var s=gantticc.tasks[i];var o=Math.ceil(s.y/GANTT_TASK_BLK_HGT);if(s.tid!=n&&o==e){s.y=s.y+t*GANTT_TASK_BLK_HGT;s.group_asset.attr({y:s.y});var u=Math.ceil(s.y/GANTT_TASK_BLK_HGT);stage.sendMessage("update_task",{tid:s.tid,row:u.toString()});if(r)this.shiftTasksByRow(e+t,t,s.tid,r)}}}};HeatMapTitle.prototype={show:function(e){this.title_asset=(new Text(this.text)).addTo(e).attr({x:this.x,y:this.y,fontFamily:"Helvetica, sans-serif",fontSize:"18px",textFillColor:color.parse(gantticc.header_color[0])})}};Date.prototype.getDaysInMonth=function(e,t){return(new Date(e,t+1,0)).getDate()};Date.prototype.getWeekNumber=function(e){e=new Date(e);e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);var n=Math.ceil(((e-t)/864e5+1)/7);return n};Date.prototype.getWeeksInYear=function(e){return 52+((new Date(e,0,1)).getDay()==4||(new Date(e,11,31)).getDay()==4)};Date.prototype.getLiteralMonth=function(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t[e]};Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1);var t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var gchart=new Gantt(0,0)